
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Speechain Toolkit">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../speech_text/">
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>abs - Speechain</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/code_select.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dataset.abs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Speechain" class="md-header__button md-logo" aria-label="Speechain" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Speechain
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              abs
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bagustris/speechain" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Speechain" class="md-nav__button md-logo" aria-label="Speechain" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Speechain
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bagustris/speechain" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpeeChain
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../asr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ASR
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TTS
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    criterion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            criterion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/abs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    abs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/accuracy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accuracy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/att_guid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    att_guid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/bce_logits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bce_logits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/cross_entropy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cross_entropy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/ctc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/error_rate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error_rate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/fbeta_score/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fbeta_score
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/least_error/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    least_error
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../criterion/perplexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perplexity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    dataset
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            dataset
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    abs
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    abs
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dataset.abs" class="md-nav__link">
    <span class="md-ellipsis">
      abs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataset.abs.Dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.collate_fn" class="md-nav__link">
    <span class="md-ellipsis">
      collate_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.collate_main_data_fn" class="md-nav__link">
    <span class="md-ellipsis">
      collate_main_data_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.data_len_register_fn" class="md-nav__link">
    <span class="md-ellipsis">
      data_len_register_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.data_selection" class="md-nav__link">
    <span class="md-ellipsis">
      data_selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.dataset_init_fn" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_init_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.extract_main_data_fn" class="md-nav__link">
    <span class="md-ellipsis">
      extract_main_data_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.get_data_index" class="md-nav__link">
    <span class="md-ellipsis">
      get_data_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.remove_data_by_index" class="md-nav__link">
    <span class="md-ellipsis">
      remove_data_by_index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../speech_text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    speech_text
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    infer_func
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            infer_func
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infer_func/beam_search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    beam_search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infer_func/ctc_decoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ctc_decoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infer_func/tts_decoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tts_decoding
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    iterator
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            iterator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iterator/abs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    abs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iterator/block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    block
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/ar_asr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ar_asr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/ar_tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ar_tts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/lm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/nar_tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nar_tts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    module
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            module
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/abs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    abs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_2" >
        
          
          <label class="md-nav__link" for="__nav_5_6_2" id="__nav_5_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    augment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_2">
            <span class="md-nav__icon md-icon"></span>
            augment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/augment/specaug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    specaug
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_3" >
        
          
          <label class="md-nav__link" for="__nav_5_6_3" id="__nav_5_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    conformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_3">
            <span class="md-nav__icon md-icon"></span>
            conformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/conformer/attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/conformer/encoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/conformer/pos_enc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pos_enc
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_4" >
        
          
          <label class="md-nav__link" for="__nav_5_6_4" id="__nav_5_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    decoder
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_4">
            <span class="md-nav__icon md-icon"></span>
            decoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/decoder/ar_asr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ar_asr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/decoder/ar_tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ar_tts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/decoder/nar_tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nar_tts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_5" >
        
          
          <label class="md-nav__link" for="__nav_5_6_5" id="__nav_5_6_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    encoder
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_5">
            <span class="md-nav__icon md-icon"></span>
            encoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/encoder/asr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/encoder/tts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6_6" id="__nav_5_6_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    frontend
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_6">
            <span class="md-nav__icon md-icon"></span>
            frontend
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/frontend/delta_feat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    delta_feat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/frontend/linear2mel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linear2mel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/frontend/speech2linear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    speech2linear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/frontend/speech2mel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    speech2mel
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_7" >
        
          
          <label class="md-nav__link" for="__nav_5_6_7" id="__nav_5_6_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    norm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_7">
            <span class="md-nav__icon md-icon"></span>
            norm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/norm/feat_norm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feat_norm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_8" >
        
          
          <label class="md-nav__link" for="__nav_5_6_8" id="__nav_5_6_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    postnet
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_8">
            <span class="md-nav__icon md-icon"></span>
            postnet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/postnet/conv1d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conv1d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/postnet/token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    token
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_9" >
        
          
          <label class="md-nav__link" for="__nav_5_6_9" id="__nav_5_6_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    prenet
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_9">
            <span class="md-nav__icon md-icon"></span>
            prenet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/prenet/conv1d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conv1d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/prenet/conv2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conv2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/prenet/embed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    embed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/prenet/linear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/prenet/spk_embed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spk_embed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/prenet/var_pred/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    var_pred
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_10" >
        
          
          <label class="md-nav__link" for="__nav_5_6_10" id="__nav_5_6_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    standalone
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_10">
            <span class="md-nav__icon md-icon"></span>
            standalone
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/standalone/lm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_11" >
        
          
          <label class="md-nav__link" for="__nav_5_6_11" id="__nav_5_6_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    transformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_11">
            <span class="md-nav__icon md-icon"></span>
            transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/transformer/attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/transformer/decoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/transformer/encoder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    encoder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/transformer/feed_forward/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feed_forward
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../module/transformer/pos_enc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pos_enc
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    monitor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    optim_sche
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            optim_sche
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optim_sche/abs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    abs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optim_sche/exp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optim_sche/noam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    noam
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_9" >
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    pyscripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            pyscripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyscripts/empty_file_checker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    empty_file_checker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyscripts/folder_summarizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    folder_summarizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyscripts/model_para_renamer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_para_renamer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyscripts/phn_duaration_visualizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phn_duaration_visualizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyscripts/text_dist_visualizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    text_dist_visualizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyscripts/wavlen_dist_visualizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wavlen_dist_visualizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../runner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    runner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../snapshooter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snapshooter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    tokenizer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            tokenizer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenizer/abs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    abs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenizer/char/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    char
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenizer/g2p/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    g2p
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenizer/sp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          <label class="md-nav__link" for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    utilbox
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            utilbox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/data_loading_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_loading_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/data_saving_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_saving_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/dump_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dump_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/eval_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eval_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/feat_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feat_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/import_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    import_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/log_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/md_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    md_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/regex_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    regex_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/sb_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sb_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/spk_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spk_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/tensor_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tensor_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/text_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    text_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/train_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    train_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/type_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    type_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilbox/yaml_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    yaml_util
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dataset.abs" class="md-nav__link">
    <span class="md-ellipsis">
      abs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataset.abs.Dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.collate_fn" class="md-nav__link">
    <span class="md-ellipsis">
      collate_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.collate_main_data_fn" class="md-nav__link">
    <span class="md-ellipsis">
      collate_main_data_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.data_len_register_fn" class="md-nav__link">
    <span class="md-ellipsis">
      data_len_register_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.data_selection" class="md-nav__link">
    <span class="md-ellipsis">
      data_selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.dataset_init_fn" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_init_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.extract_main_data_fn" class="md-nav__link">
    <span class="md-ellipsis">
      extract_main_data_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.get_data_index" class="md-nav__link">
    <span class="md-ellipsis">
      get_data_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataset.abs.Dataset.remove_data_by_index" class="md-nav__link">
    <span class="md-ellipsis">
      remove_data_by_index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>abs</h1>

<div class="doc doc-object doc-module">



<a id="dataset.abs"></a>
    <div class="doc doc-contents first">

        <p>Author: Heli Qi
Affiliation: NAIST
Date: 2022.07</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="dataset.abs.Dataset" class="doc doc-heading">
            <code>Dataset</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.utils.data.Dataset">Dataset</span></code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for reading and packaging data instances from disk into memory for model training or testing.</p>
<p>The Dataset receives indices of selected data instances from a Dataloader object, created by a high-level Iterator.
Post-processing steps may need to be executed in the Model object later as the output batches might not be fully processed.</p>






              <details class="quote">
                <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Dataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Base class for reading and packaging data instances from disk into memory for model training or testing.</span>

<span class="sd">    The Dataset receives indices of selected data instances from a Dataloader object, created by a high-level Iterator.</span>
<span class="sd">    Post-processing steps may need to be executed in the Model object later as the output batches might not be fully processed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
        <span class="n">data_selection</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">dataset_conf</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This initialization function reads the main body of the data instances into the memory. The main body is used to</span>
<span class="sd">        extract individual data instances from the disk to form a batch during model training or testing.</span>

<span class="sd">        The hook dataset_init_fn() is executed here after reading the main body of data instances.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_data (Dict[str, Union[str, List[str]]]):</span>
<span class="sd">                Dictionary containing data instances used in the Dataset object. Each key-value pair consists of a data</span>
<span class="sd">                variable name and an absolute path to the corresponding &#39;idx2data&#39; file. The value can be a single path string</span>
<span class="sd">                or a list of multiple path strings.</span>

<span class="sd">            data_selection (Optional[List[Union[List[str], str]]]):</span>
<span class="sd">                Strategies for data selection to limit used data instances during iterator initialization. Multiple strategies</span>
<span class="sd">                can be specified in a list. Each data selection strategy should be either a bi-list (non-meta strategy)</span>
<span class="sd">                or tri-list (meta strategy). Refer to the function docstring of data_selection() for more details on</span>
<span class="sd">                the selection strategies.</span>

<span class="sd">            **dataset_conf: Additional configuration arguments for custom Dataset initialization.</span>

<span class="sd">            data_selection: List[List[str] or str] = None</span>
<span class="sd">                The strategies for data selection during the iterator initialization to shrink the used data instances.</span>
<span class="sd">                Multiple strategies can be specified in a list. Each data selection strategy must be either a bi-list</span>
<span class="sd">                (non-meta strategy) or tri-list (meta strategy).</span>
<span class="sd">                1. non-meta strategy:</span>
<span class="sd">                    The selection strategies that don&#39;t involve metadata. These strategies should be given as a bi-list,</span>
<span class="sd">                    i.e., [&#39;selection mode&#39;, &#39;selection number&#39;]. &#39;selection mode&#39; indicates the way to select data</span>
<span class="sd">                    instances while &#39;selection number&#39; indicates how many data instances to be selected.</span>
<span class="sd">                    Currently, available non-meta selection modes include:</span>
<span class="sd">                        1. &#39;order&#39;: Select the given number of data instances from the beginning.</span>
<span class="sd">                        2. &#39;rev_order&#39;: Select the given number of data instances from the end.</span>
<span class="sd">                        3. &#39;random&#39;: Randomly select the given number of data instances.</span>
<span class="sd">                            Note: You should keep the same random seeds for all the GPU processes in the DDP mode to</span>
<span class="sd">                            ensure that the selected data instances are the same in each process. In this case, please</span>
<span class="sd">                            set the &#39;same_proc_seed&#39; argument to True in your configuration given to speechain.runner</span>
<span class="sd">                2. meta strategy:</span>
<span class="sd">                    The selection strategies that involves metadata. These strategies should be given as a tri-list,</span>
<span class="sd">                    i.e., [&#39;selection mode&#39;, &#39;selection threshold&#39;, &#39;metadata path&#39;]. &#39;selection mode&#39; indicates the</span>
<span class="sd">                    way to select data instances, &#39;selection threshold&#39; indicates the metadata threshold to select data</span>
<span class="sd">                    instances, and &#39;metadata path&#39; indicates where is the metadata used for selection.</span>
<span class="sd">                    Currently, available meta selection modes include:</span>
<span class="sd">                        1. &#39;min&#39;: Select the data instances whose metadata is smaller than the threshold.</span>
<span class="sd">                        2. &#39;max&#39;: Select the data instances whose metadata is larger than the threshold.</span>
<span class="sd">                        3. &#39;middle&#39;: Remove the data instances whose metadata is the largest and smallest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Validate main_data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">main_data</span><span class="p">,</span> <span class="n">Dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected main_data to be a Dict, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">main_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Load main body of data instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="n">read_idx2data_file_to_dict</span><span class="p">(</span><span class="n">main_data</span><span class="p">)</span>

        <span class="c1"># Apply data selection if specified</span>
        <span class="k">if</span> <span class="n">data_selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Ensure data_selection is a list of lists</span>
            <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">List</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_selection</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">data_selection</span>
            <span class="p">):</span>
                <span class="n">data_selection</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_selection</span><span class="p">]</span>

            <span class="c1"># Iterate through each selection strategy</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_selection</span><span class="p">:</span>
                <span class="c1"># Non-meta selection</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">selection_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="s2">&quot;rev_order&quot;</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;For non-meta selection, mode must be &#39;random&#39;, &#39;order&#39;, or &#39;rev_order&#39;. Got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                <span class="c1"># Meta-required selection</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">selection_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;For meta selection, mode must be &#39;min&#39;, &#39;max&#39;, &#39;middle&#39;, or &#39;group&#39;. Got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Each element of data_selection should be either a 2-element or 3-element list&quot;</span>
                    <span class="p">)</span>

                <span class="c1"># Validate selection_num</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="c1"># Non-numerical contents are turned into a list for identification</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="n">selection_num</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                        <span class="ow">and</span> <span class="ow">not</span> <span class="n">selection_num</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                    <span class="p">):</span>
                        <span class="k">assert</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span>
                        <span class="n">selection_num</span> <span class="o">=</span> <span class="p">[</span><span class="n">selection_num</span><span class="p">]</span>

                <span class="n">valid_selection_num</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span>
                    <span class="p">)</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_selection_num</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Data selection number should be a float number between 0 and 1, a negative integer, &quot;</span>
                        <span class="s2">&quot;a string, or a list of strings&quot;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="o">-</span><span class="n">selection_num</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Data selection amount cannot be larger than total number of data instances&quot;</span>
                    <span class="p">)</span>

                <span class="c1"># Apply the data selection</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_selection</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">,</span> <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span>
                <span class="p">)</span>

        <span class="c1"># Custom initialization for subclasses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_len_register_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_init_fn</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_conf</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">data_len_register_fn</span><span class="p">(</span>
        <span class="n">main_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Static hook function that registers default information about the length of each data instance.</span>

<span class="sd">        By default, this function does nothing. If you need to decide the data length on-the-fly, override this function</span>
<span class="sd">        with your own implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_data (Dict[str, Dict[str, str]]): Dictionary of main data from which length information is derived.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Union[int, float]] or None: Dictionary mapping data instances to their lengths, or None if not implemented.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">dataset_init_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">dataset_conf</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hook function that initializes the custom parts of dataset implementations.</span>

<span class="sd">        By default, this function does nothing. If your Dataset subclass has custom parts, override this function</span>
<span class="sd">        with your own implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            **dataset_conf: Arguments for the custom initialization of the Dataset subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">data_selection</span><span class="p">(</span>
        <span class="n">data_index</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">selection_mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">selection_num</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">meta_info</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects data instances based on the provided selection strategy.</span>

<span class="sd">        Returns a new list of selected data instances.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_index (List[str]):</span>
<span class="sd">                List of data instance indices prior to data selection.</span>
<span class="sd">            selection_num (Union[float, int, str]):</span>
<span class="sd">                Indicates how many data instances to select, varying with its data type.</span>
<span class="sd">                float: Represents the relative number of data instances to select (between 0 and 1).</span>
<span class="sd">                int: Represents the absolute number of data instances to select. If negative, its absolute value is taken.</span>
<span class="sd">                str: Represents the metadata threshold for data selection. Only &#39;min&#39; and &#39;max&#39; modes support this.</span>
<span class="sd">                    You can use the !-suffixed representer `!str` to convert a float or integer number to a string in your .yaml file.</span>
<span class="sd">            selection_mode: str</span>
<span class="sd">                Defines the selection strategy:</span>
<span class="sd">                1. non-meta strategy:</span>
<span class="sd">                   Rule-based selection strategies that do not involve metadata. Includes:</span>
<span class="sd">                     1. &#39;order&#39;: Selects the given number of data instances from the beginning.</span>
<span class="sd">                     2. &#39;rev_order&#39;: Selects the given number of data instances from the end.</span>
<span class="sd">                     3. &#39;random&#39;: Selects the given number of data instances randomly.</span>
<span class="sd">                         Note: You should keep the same random seeds for all the GPU processes in the DDP mode to ensure</span>
<span class="sd">                         that the selected data instances are the same in each process. In this case, please set the</span>
<span class="sd">                         &#39;same_proc_seed&#39; argument to True in your configuration given to speechain.runner.py.</span>
<span class="sd">                2. meta strategy:</span>
<span class="sd">                   Selection strategies that involve metadata. Includes:</span>
<span class="sd">                     1. &#39;min&#39;: Selects the data instances whose metadata is smaller than the threshold.</span>
<span class="sd">                     2. &#39;max&#39;: Selects the data instances whose metadata is larger than the threshold.</span>
<span class="sd">                     3. &#39;middle&#39;: Removes the data instances whose metadata is the largest and smallest.</span>
<span class="sd">            meta_info (Union[List[str], str, None], optional):</span>
<span class="sd">                Path to metadata information used for selection. Defaults to None.</span>

<span class="sd">        Returns: List[str]</span>
<span class="sd">            List[str]: A list of selected data instance indices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert data_index to numpy.array for easier manipulation</span>
        <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

        <span class="c1"># Non-metadata selection strategies</span>
        <span class="k">if</span> <span class="n">meta_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
            <span class="c1"># Determine absolute or relative number of instances to select</span>
            <span class="n">selection_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="o">-</span><span class="n">selection_num</span>
                <span class="k">if</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">selection_num</span>
            <span class="p">)</span>
            <span class="c1"># Selection from the beginning</span>
            <span class="k">if</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;order&quot;</span><span class="p">:</span>
                <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:</span><span class="n">selection_num</span><span class="p">]</span>
            <span class="c1"># Selection from the end</span>
            <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;rev_order&quot;</span><span class="p">:</span>
                <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span><span class="o">-</span><span class="n">selection_num</span><span class="p">:]</span>
            <span class="c1"># Random selection</span>
            <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
                <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">),</span> <span class="n">selection_num</span><span class="p">)</span>
                <span class="p">]</span>

        <span class="c1"># Metadata-based selection strategies</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Load metadata information</span>
            <span class="n">meta_info</span> <span class="o">=</span> <span class="n">load_idx2data_file</span><span class="p">(</span><span class="n">meta_info</span><span class="p">)</span>
            <span class="n">meta_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">meta_info</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
            <span class="c1"># Initialize sorted indices and metadata values</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">meta_sorted_data</span> <span class="o">=</span> <span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
                <span class="p">]</span>
                <span class="n">meta_sorted_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
            <span class="c1"># Catch conversion errors</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">meta_sorted_data</span> <span class="o">=</span> <span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">meta_sorted_value</span> <span class="o">=</span> <span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Only retain data instances present in both datasets</span>
            <span class="n">retain_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">meta_sorted_data</span><span class="p">,</span> <span class="n">sorted_data</span><span class="p">)</span>
            <span class="n">meta_sorted_data</span><span class="p">,</span> <span class="n">meta_sorted_value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">meta_sorted_data</span><span class="p">[</span><span class="n">retain_flags</span><span class="p">],</span>
                <span class="n">meta_sorted_value</span><span class="p">[</span><span class="n">retain_flags</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="c1"># Process selection based on provided selection_num</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="c1"># 0 &lt; selection_num &lt; 1 means that we relatively select data instances by a percentage number</span>
                <span class="c1"># selection_num &lt; 0 means that we absolutely select data instances by the given value</span>
                <span class="n">selection_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                    <span class="o">-</span><span class="n">selection_num</span>
                    <span class="k">if</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_sorted_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">selection_num</span>
                <span class="p">)</span>
                <span class="c1"># &#39;min&#39; means the instances with the minimal meta values will be selected</span>
                <span class="k">if</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                    <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span><span class="n">selection_num</span><span class="p">:]</span>
                <span class="c1"># &#39;max&#39; means the instances with the maximal meta values will be selected</span>
                <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
                    <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[:</span><span class="o">-</span><span class="n">selection_num</span><span class="p">]</span>
                <span class="c1"># &#39;middle&#39; means the instances with the minimal and maximal meta values will be excluded</span>
                <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span>
                    <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">(</span>
                            <span class="n">meta_sorted_data</span><span class="p">[</span>
                                <span class="p">:</span> <span class="nb">int</span><span class="p">((</span><span class="n">meta_sorted_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">selection_num</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                            <span class="p">],</span>
                            <span class="n">meta_sorted_data</span><span class="p">[</span>
                                <span class="o">-</span><span class="nb">int</span><span class="p">((</span><span class="n">meta_sorted_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">selection_num</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span>
                            <span class="p">],</span>
                        <span class="p">),</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;If selection_num is given in a integer or float number (</span><span class="si">{</span><span class="n">selection_num</span><span class="si">}</span><span class="s2">), &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;selection_mode must be one of [&#39;min&#39;, &#39;max&#39;, &#39;middle&#39;]. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;But got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>

            <span class="c1"># select the data instances by a given threshold</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">selection_num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">selection_num</span><span class="p">)</span>
                <span class="c1"># &#39;min&#39; means the instances whose metadata is lower than the given threshold will be selected</span>
                <span class="k">if</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                    <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span>
                        <span class="n">meta_sorted_value</span> <span class="o">&gt;</span> <span class="n">selection_num</span>
                    <span class="p">]</span>
                <span class="c1"># &#39;max&#39; means the instances whose metadata is larger than the given threshold will be selected</span>
                <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
                    <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span>
                        <span class="n">meta_sorted_value</span> <span class="o">&lt;</span> <span class="n">selection_num</span>
                    <span class="p">]</span>
                <span class="c1"># &#39;middle&#39; is not supported for the threshold selection</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;If selection_num is given in a string (</span><span class="si">{</span><span class="n">selection_num</span><span class="si">}</span><span class="s2">), selection_mode must &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;be one of [&#39;min&#39;, &#39;max&#39;]. But got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>

            <span class="c1"># other strings mean the target groups of data instances</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
                <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span>
                    <span class="p">[</span>
                        <span class="kc">True</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selection_num</span> <span class="k">else</span> <span class="kc">False</span>
                        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">meta_sorted_value</span>
                    <span class="p">]</span>
                <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid type for selection_num.&quot;</span><span class="p">)</span>

            <span class="c1"># Remove undesired instances from sorted_data</span>
            <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">,</span> <span class="n">removed_sorted_data</span><span class="p">)</span>

        <span class="c1"># Return selected indices as list</span>
        <span class="k">return</span> <span class="n">sorted_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_data_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is designed to make users know the data indices of this Dataset object without accessing its</span>
<span class="sd">        members for lower coupling.</span>

<span class="sd">        Returns: List[str]</span>
<span class="sd">            The list of the indices of all data instances in this dataset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span>

    <span class="k">def</span> <span class="nf">remove_data_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function removes the corresponding data instance from this Dataset object by the given index. It&#39;s mainly</span>
<span class="sd">        used for solving the index mismatch of data instances with the high-level Iterator object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># remove the data instances with the given index from self.main_data</span>
        <span class="k">for</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is the implementation of the one in the parent class `torch.utils.data.Dataset`.  This function</span>
<span class="sd">        is activated by the _Dataloader_ object one data instance a time. In each time, this function receives an index</span>
<span class="sd">        and returns the selected data instance.</span>

<span class="sd">        The hook `proc_main_data_fn()` is executed here after extracting the main body of the selected data instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            index: str</span>
<span class="sd">                The index of the selected data instance given by the Dataloader object.</span>

<span class="sd">        Returns: Dict[str, Any]</span>
<span class="sd">            A dictionary containing a data instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pre-extract the data instances from self.main_data dictionary by the given index</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="c1"># process the main body of data instances by the hook interface implementation</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_main_data_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">extract_main_data_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This hook function extracts the selected data instance from the disk to the memory. If you want to implement</span>
<span class="sd">        your own data instance extraction, please override this hook function and give your logic here.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_data: Dict[str, str]</span>
<span class="sd">                The dictionary containing necessary information for extracting the data instance from the disk to the</span>
<span class="sd">                memory. For example, the audio file path for the waveform data and the feature file path for the speaker</span>
<span class="sd">                embedding.</span>

<span class="sd">        Returns: Dict[str, Any]</span>
<span class="sd">            The dictionary containing the extracted data instance.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">main_data</span>

    <span class="k">def</span> <span class="nf">collate_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This hook function decides how to preprocess a list of extracted data instance dictionary before giving them to</span>
<span class="sd">        the model. This hook function is used as the value of the argument collate_fn for initializing Dataloader object</span>
<span class="sd">        at the beginning of each epoch.</span>

<span class="sd">        If you have your own batch collating strategy, we don&#39;t recommend you to override this hook but another hook</span>
<span class="sd">        named `collate_main_data_fn()`.</span>

<span class="sd">        This function should return the processed batch data in the form of a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            batch: List[Dict[str, Any]]</span>
<span class="sd">                The tuple of data instance dictionaries extracted by `extract_main_data_fn()`.</span>

<span class="sd">        Returns: Dict[str, Any]</span>
<span class="sd">            The batch dictionary that will be passed to the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># preprocess List[Dict[str, Any]] to Dict[str, List[Any]]</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ele_dict</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ele_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ele_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="c1"># remove the redundant data for memory safety</span>
            <span class="n">batch</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ele_dict</span><span class="p">)</span>

        <span class="c1"># postprocess Dict[str, List[Any]] by the hook implementation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate_main_data_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">collate_main_data_fn</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">batch_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="ow">or</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This hook function decides how to preprocess a dictionary of the extracted batch of data instances before giving</span>
<span class="sd">        them to the model. The original hook in the base class packages all the elements other than strings of the batch</span>
<span class="sd">        into a `torch.Tensor`. Therefore, the `torch.Tensor` elements must have the same shape. The string elements will</span>
<span class="sd">        remain a list.</span>

<span class="sd">        If you have your own batch collating strategy, please override this hook function and give your logic here.</span>

<span class="sd">        Args:</span>
<span class="sd">            batch_dict: Dict[str, List]</span>
<span class="sd">                The reshaped dictionary of the extracted batch. In each key-value item, the key is the name of the data</span>
<span class="sd">                variable that will be passed to the model and the value is the list of unorganized data from all the</span>
<span class="sd">                elements in the batch.</span>

<span class="sd">        Returns: Dict[str, torch.Tensor or List]</span>
<span class="sd">            The dictionary containing the collated batch of data instances.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># extract the main body of data instances by the hook interface implementation</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">batch_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># List[torch.Tensor] -&gt; torch.Tensor</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
                <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">ele</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]])</span>
            <span class="c1"># List[numpy.ndarry] -&gt; List[torch.Tensor] -&gt; torch.Tensor</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
                <span class="p">)</span>
            <span class="c1"># List[int] -&gt; torch.LongTensor</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="c1"># List[float] -&gt; torch.FloatTensor</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="c1"># List[str] remains List[str]</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span>

        <span class="k">return</span> <span class="n">batch_dict</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function is the implementation of the one in the parent class <code>torch.utils.data.Dataset</code>.  This function
is activated by the <em>Dataloader</em> object one data instance a time. In each time, this function receives an index
and returns the selected data instance.</p>
<p>The hook <code>proc_main_data_fn()</code> is executed here after extracting the main body of the selected data instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str
The index of the selected data instance given by the Dataloader object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Dict[str, Any]</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing a data instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is the implementation of the one in the parent class `torch.utils.data.Dataset`.  This function</span>
<span class="sd">    is activated by the _Dataloader_ object one data instance a time. In each time, this function receives an index</span>
<span class="sd">    and returns the selected data instance.</span>

<span class="sd">    The hook `proc_main_data_fn()` is executed here after extracting the main body of the selected data instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        index: str</span>
<span class="sd">            The index of the selected data instance given by the Dataloader object.</span>

<span class="sd">    Returns: Dict[str, Any]</span>
<span class="sd">        A dictionary containing a data instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pre-extract the data instances from self.main_data dictionary by the given index</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="c1"># process the main body of data instances by the hook interface implementation</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_main_data_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">main_data</span><span class="p">,</span> <span class="n">data_selection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">dataset_conf</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This initialization function reads the main body of the data instances into the memory. The main body is used to
extract individual data instances from the disk to form a batch during model training or testing.</p>
<p>The hook dataset_init_fn() is executed here after reading the main body of data instances.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>main_data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[str]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing data instances used in the Dataset object. Each key-value pair consists of a data
variable name and an absolute path to the corresponding 'idx2data' file. The value can be a single path string
or a list of multiple path strings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_selection</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], str]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategies for data selection to limit used data instances during iterator initialization. Multiple strategies
can be specified in a list. Each data selection strategy should be either a bi-list (non-meta strategy)
or tri-list (meta strategy). Refer to the function docstring of data_selection() for more details on
the selection strategies.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**dataset_conf</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional configuration arguments for custom Dataset initialization.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_selection</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], str]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[List[str] or str] = None
The strategies for data selection during the iterator initialization to shrink the used data instances.
Multiple strategies can be specified in a list. Each data selection strategy must be either a bi-list
(non-meta strategy) or tri-list (meta strategy).
1. non-meta strategy:
    The selection strategies that don't involve metadata. These strategies should be given as a bi-list,
    i.e., ['selection mode', 'selection number']. 'selection mode' indicates the way to select data
    instances while 'selection number' indicates how many data instances to be selected.
    Currently, available non-meta selection modes include:
        1. 'order': Select the given number of data instances from the beginning.
        2. 'rev_order': Select the given number of data instances from the end.
        3. 'random': Randomly select the given number of data instances.
            Note: You should keep the same random seeds for all the GPU processes in the DDP mode to
            ensure that the selected data instances are the same in each process. In this case, please
            set the 'same_proc_seed' argument to True in your configuration given to speechain.runner
2. meta strategy:
    The selection strategies that involves metadata. These strategies should be given as a tri-list,
    i.e., ['selection mode', 'selection threshold', 'metadata path']. 'selection mode' indicates the
    way to select data instances, 'selection threshold' indicates the metadata threshold to select data
    instances, and 'metadata path' indicates where is the metadata used for selection.
    Currently, available meta selection modes include:
        1. 'min': Select the data instances whose metadata is smaller than the threshold.
        2. 'max': Select the data instances whose metadata is larger than the threshold.
        3. 'middle': Remove the data instances whose metadata is the largest and smallest.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">main_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
    <span class="n">data_selection</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dataset_conf</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This initialization function reads the main body of the data instances into the memory. The main body is used to</span>
<span class="sd">    extract individual data instances from the disk to form a batch during model training or testing.</span>

<span class="sd">    The hook dataset_init_fn() is executed here after reading the main body of data instances.</span>

<span class="sd">    Args:</span>
<span class="sd">        main_data (Dict[str, Union[str, List[str]]]):</span>
<span class="sd">            Dictionary containing data instances used in the Dataset object. Each key-value pair consists of a data</span>
<span class="sd">            variable name and an absolute path to the corresponding &#39;idx2data&#39; file. The value can be a single path string</span>
<span class="sd">            or a list of multiple path strings.</span>

<span class="sd">        data_selection (Optional[List[Union[List[str], str]]]):</span>
<span class="sd">            Strategies for data selection to limit used data instances during iterator initialization. Multiple strategies</span>
<span class="sd">            can be specified in a list. Each data selection strategy should be either a bi-list (non-meta strategy)</span>
<span class="sd">            or tri-list (meta strategy). Refer to the function docstring of data_selection() for more details on</span>
<span class="sd">            the selection strategies.</span>

<span class="sd">        **dataset_conf: Additional configuration arguments for custom Dataset initialization.</span>

<span class="sd">        data_selection: List[List[str] or str] = None</span>
<span class="sd">            The strategies for data selection during the iterator initialization to shrink the used data instances.</span>
<span class="sd">            Multiple strategies can be specified in a list. Each data selection strategy must be either a bi-list</span>
<span class="sd">            (non-meta strategy) or tri-list (meta strategy).</span>
<span class="sd">            1. non-meta strategy:</span>
<span class="sd">                The selection strategies that don&#39;t involve metadata. These strategies should be given as a bi-list,</span>
<span class="sd">                i.e., [&#39;selection mode&#39;, &#39;selection number&#39;]. &#39;selection mode&#39; indicates the way to select data</span>
<span class="sd">                instances while &#39;selection number&#39; indicates how many data instances to be selected.</span>
<span class="sd">                Currently, available non-meta selection modes include:</span>
<span class="sd">                    1. &#39;order&#39;: Select the given number of data instances from the beginning.</span>
<span class="sd">                    2. &#39;rev_order&#39;: Select the given number of data instances from the end.</span>
<span class="sd">                    3. &#39;random&#39;: Randomly select the given number of data instances.</span>
<span class="sd">                        Note: You should keep the same random seeds for all the GPU processes in the DDP mode to</span>
<span class="sd">                        ensure that the selected data instances are the same in each process. In this case, please</span>
<span class="sd">                        set the &#39;same_proc_seed&#39; argument to True in your configuration given to speechain.runner</span>
<span class="sd">            2. meta strategy:</span>
<span class="sd">                The selection strategies that involves metadata. These strategies should be given as a tri-list,</span>
<span class="sd">                i.e., [&#39;selection mode&#39;, &#39;selection threshold&#39;, &#39;metadata path&#39;]. &#39;selection mode&#39; indicates the</span>
<span class="sd">                way to select data instances, &#39;selection threshold&#39; indicates the metadata threshold to select data</span>
<span class="sd">                instances, and &#39;metadata path&#39; indicates where is the metadata used for selection.</span>
<span class="sd">                Currently, available meta selection modes include:</span>
<span class="sd">                    1. &#39;min&#39;: Select the data instances whose metadata is smaller than the threshold.</span>
<span class="sd">                    2. &#39;max&#39;: Select the data instances whose metadata is larger than the threshold.</span>
<span class="sd">                    3. &#39;middle&#39;: Remove the data instances whose metadata is the largest and smallest.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Dataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># Validate main_data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">main_data</span><span class="p">,</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Expected main_data to be a Dict, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">main_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Load main body of data instances</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="n">read_idx2data_file_to_dict</span><span class="p">(</span><span class="n">main_data</span><span class="p">)</span>

    <span class="c1"># Apply data selection if specified</span>
    <span class="k">if</span> <span class="n">data_selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Ensure data_selection is a list of lists</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">List</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_selection</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="n">data_selection</span>
        <span class="p">):</span>
            <span class="n">data_selection</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_selection</span><span class="p">]</span>

        <span class="c1"># Iterate through each selection strategy</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_selection</span><span class="p">:</span>
            <span class="c1"># Non-meta selection</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">selection_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;random&quot;</span><span class="p">,</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="s2">&quot;rev_order&quot;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;For non-meta selection, mode must be &#39;random&#39;, &#39;order&#39;, or &#39;rev_order&#39;. Got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
            <span class="c1"># Meta-required selection</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">selection_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;For meta selection, mode must be &#39;min&#39;, &#39;max&#39;, &#39;middle&#39;, or &#39;group&#39;. Got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Each element of data_selection should be either a 2-element or 3-element list&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Validate selection_num</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Non-numerical contents are turned into a list for identification</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">selection_num</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">selection_num</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="k">assert</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span>
                    <span class="n">selection_num</span> <span class="o">=</span> <span class="p">[</span><span class="n">selection_num</span><span class="p">]</span>

            <span class="n">valid_selection_num</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="p">)</span>
                <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_selection_num</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Data selection number should be a float number between 0 and 1, a negative integer, &quot;</span>
                    <span class="s2">&quot;a string, or a list of strings&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="o">-</span><span class="n">selection_num</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Data selection amount cannot be larger than total number of data instances&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Apply the data selection</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_selection</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span><span class="p">,</span> <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span>
            <span class="p">)</span>

    <span class="c1"># Custom initialization for subclasses</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_len_register_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dataset_init_fn</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_conf</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.collate_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collate_fn</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This hook function decides how to preprocess a list of extracted data instance dictionary before giving them to
the model. This hook function is used as the value of the argument collate_fn for initializing Dataloader object
at the beginning of each epoch.</p>
<p>If you have your own batch collating strategy, we don't recommend you to override this hook but another hook
named <code>collate_main_data_fn()</code>.</p>
<p>This function should return the processed batch data in the form of a dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, Any]]
The tuple of data instance dictionaries extracted by <code>extract_main_data_fn()</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Dict[str, Any]</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batch dictionary that will be passed to the model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">collate_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This hook function decides how to preprocess a list of extracted data instance dictionary before giving them to</span>
<span class="sd">    the model. This hook function is used as the value of the argument collate_fn for initializing Dataloader object</span>
<span class="sd">    at the beginning of each epoch.</span>

<span class="sd">    If you have your own batch collating strategy, we don&#39;t recommend you to override this hook but another hook</span>
<span class="sd">    named `collate_main_data_fn()`.</span>

<span class="sd">    This function should return the processed batch data in the form of a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch: List[Dict[str, Any]]</span>
<span class="sd">            The tuple of data instance dictionaries extracted by `extract_main_data_fn()`.</span>

<span class="sd">    Returns: Dict[str, Any]</span>
<span class="sd">        The batch dictionary that will be passed to the model.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># preprocess List[Dict[str, Any]] to Dict[str, List[Any]]</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ele_dict</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ele_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ele_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ele_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="c1"># remove the redundant data for memory safety</span>
        <span class="n">batch</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ele_dict</span><span class="p">)</span>

    <span class="c1"># postprocess Dict[str, List[Any]] by the hook implementation</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate_main_data_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.collate_main_data_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collate_main_data_fn</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This hook function decides how to preprocess a dictionary of the extracted batch of data instances before giving
them to the model. The original hook in the base class packages all the elements other than strings of the batch
into a <code>torch.Tensor</code>. Therefore, the <code>torch.Tensor</code> elements must have the same shape. The string elements will
remain a list.</p>
<p>If you have your own batch collating strategy, please override this hook function and give your logic here.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_dict</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.List">List</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, List]
The reshaped dictionary of the extracted batch. In each key-value item, the key is the name of the data
variable that will be passed to the model and the value is the list of unorganized data from all the
elements in the batch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Dict[str, torch.Tensor or List]</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="torch.Tensor">Tensor</span> or <span title="typing.List">List</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the collated batch of data instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">collate_main_data_fn</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">batch_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="ow">or</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This hook function decides how to preprocess a dictionary of the extracted batch of data instances before giving</span>
<span class="sd">    them to the model. The original hook in the base class packages all the elements other than strings of the batch</span>
<span class="sd">    into a `torch.Tensor`. Therefore, the `torch.Tensor` elements must have the same shape. The string elements will</span>
<span class="sd">    remain a list.</span>

<span class="sd">    If you have your own batch collating strategy, please override this hook function and give your logic here.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_dict: Dict[str, List]</span>
<span class="sd">            The reshaped dictionary of the extracted batch. In each key-value item, the key is the name of the data</span>
<span class="sd">            variable that will be passed to the model and the value is the list of unorganized data from all the</span>
<span class="sd">            elements in the batch.</span>

<span class="sd">    Returns: Dict[str, torch.Tensor or List]</span>
<span class="sd">        The dictionary containing the collated batch of data instances.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># extract the main body of data instances by the hook interface implementation</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">batch_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1"># List[torch.Tensor] -&gt; torch.Tensor</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
            <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">ele</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]])</span>
        <span class="c1"># List[numpy.ndarry] -&gt; List[torch.Tensor] -&gt; torch.Tensor</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
                <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ele</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
            <span class="p">)</span>
        <span class="c1"># List[int] -&gt; torch.LongTensor</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="c1"># List[float] -&gt; torch.FloatTensor</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="c1"># List[str] remains List[str]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span>

    <span class="k">return</span> <span class="n">batch_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.data_len_register_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_len_register_fn</span><span class="p">(</span><span class="n">main_data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Static hook function that registers default information about the length of each data instance.</p>
<p>By default, this function does nothing. If you need to decide the data length on-the-fly, override this function
with your own implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>main_data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Dict">Dict</span>[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of main data from which length information is derived.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[int, float]], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, Union[int, float]] or None: Dictionary mapping data instances to their lengths, or None if not implemented.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">data_len_register_fn</span><span class="p">(</span>
    <span class="n">main_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Static hook function that registers default information about the length of each data instance.</span>

<span class="sd">    By default, this function does nothing. If you need to decide the data length on-the-fly, override this function</span>
<span class="sd">    with your own implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        main_data (Dict[str, Dict[str, str]]): Dictionary of main data from which length information is derived.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Union[int, float]] or None: Dictionary mapping data instances to their lengths, or None if not implemented.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.data_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_selection</span><span class="p">(</span><span class="n">data_index</span><span class="p">,</span> <span class="n">selection_mode</span><span class="p">,</span> <span class="n">selection_num</span><span class="p">,</span> <span class="n">meta_info</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Selects data instances based on the provided selection strategy.</p>
<p>Returns a new list of selected data instances.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_index</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of data instance indices prior to data selection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_num</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[float, int, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates how many data instances to select, varying with its data type.
float: Represents the relative number of data instances to select (between 0 and 1).
int: Represents the absolute number of data instances to select. If negative, its absolute value is taken.
str: Represents the metadata threshold for data selection. Only 'min' and 'max' modes support this.
    You can use the !-suffixed representer <code>!str</code> to convert a float or integer number to a string in your .yaml file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_mode</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str
Defines the selection strategy:
1. non-meta strategy:
   Rule-based selection strategies that do not involve metadata. Includes:
     1. 'order': Selects the given number of data instances from the beginning.
     2. 'rev_order': Selects the given number of data instances from the end.
     3. 'random': Selects the given number of data instances randomly.
         Note: You should keep the same random seeds for all the GPU processes in the DDP mode to ensure
         that the selected data instances are the same in each process. In this case, please set the
         'same_proc_seed' argument to True in your configuration given to speechain.runner.py.
2. meta strategy:
   Selection strategies that involve metadata. Includes:
     1. 'min': Selects the data instances whose metadata is smaller than the threshold.
     2. 'max': Selects the data instances whose metadata is larger than the threshold.
     3. 'middle': Removes the data instances whose metadata is the largest and smallest.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>meta_info</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to metadata information used for selection. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">List[str]</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[str]: A list of selected data instance indices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">data_selection</span><span class="p">(</span>
    <span class="n">data_index</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">selection_mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">selection_num</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">meta_info</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects data instances based on the provided selection strategy.</span>

<span class="sd">    Returns a new list of selected data instances.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_index (List[str]):</span>
<span class="sd">            List of data instance indices prior to data selection.</span>
<span class="sd">        selection_num (Union[float, int, str]):</span>
<span class="sd">            Indicates how many data instances to select, varying with its data type.</span>
<span class="sd">            float: Represents the relative number of data instances to select (between 0 and 1).</span>
<span class="sd">            int: Represents the absolute number of data instances to select. If negative, its absolute value is taken.</span>
<span class="sd">            str: Represents the metadata threshold for data selection. Only &#39;min&#39; and &#39;max&#39; modes support this.</span>
<span class="sd">                You can use the !-suffixed representer `!str` to convert a float or integer number to a string in your .yaml file.</span>
<span class="sd">        selection_mode: str</span>
<span class="sd">            Defines the selection strategy:</span>
<span class="sd">            1. non-meta strategy:</span>
<span class="sd">               Rule-based selection strategies that do not involve metadata. Includes:</span>
<span class="sd">                 1. &#39;order&#39;: Selects the given number of data instances from the beginning.</span>
<span class="sd">                 2. &#39;rev_order&#39;: Selects the given number of data instances from the end.</span>
<span class="sd">                 3. &#39;random&#39;: Selects the given number of data instances randomly.</span>
<span class="sd">                     Note: You should keep the same random seeds for all the GPU processes in the DDP mode to ensure</span>
<span class="sd">                     that the selected data instances are the same in each process. In this case, please set the</span>
<span class="sd">                     &#39;same_proc_seed&#39; argument to True in your configuration given to speechain.runner.py.</span>
<span class="sd">            2. meta strategy:</span>
<span class="sd">               Selection strategies that involve metadata. Includes:</span>
<span class="sd">                 1. &#39;min&#39;: Selects the data instances whose metadata is smaller than the threshold.</span>
<span class="sd">                 2. &#39;max&#39;: Selects the data instances whose metadata is larger than the threshold.</span>
<span class="sd">                 3. &#39;middle&#39;: Removes the data instances whose metadata is the largest and smallest.</span>
<span class="sd">        meta_info (Union[List[str], str, None], optional):</span>
<span class="sd">            Path to metadata information used for selection. Defaults to None.</span>

<span class="sd">    Returns: List[str]</span>
<span class="sd">        List[str]: A list of selected data instance indices.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert data_index to numpy.array for easier manipulation</span>
    <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Non-metadata selection strategies</span>
    <span class="k">if</span> <span class="n">meta_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
        <span class="c1"># Determine absolute or relative number of instances to select</span>
        <span class="n">selection_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="o">-</span><span class="n">selection_num</span>
            <span class="k">if</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">selection_num</span>
        <span class="p">)</span>
        <span class="c1"># Selection from the beginning</span>
        <span class="k">if</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;order&quot;</span><span class="p">:</span>
            <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[:</span><span class="n">selection_num</span><span class="p">]</span>
        <span class="c1"># Selection from the end</span>
        <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;rev_order&quot;</span><span class="p">:</span>
            <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span><span class="o">-</span><span class="n">selection_num</span><span class="p">:]</span>
        <span class="c1"># Random selection</span>
        <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
            <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">sorted_data</span><span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">),</span> <span class="n">selection_num</span><span class="p">)</span>
            <span class="p">]</span>

    <span class="c1"># Metadata-based selection strategies</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Load metadata information</span>
        <span class="n">meta_info</span> <span class="o">=</span> <span class="n">load_idx2data_file</span><span class="p">(</span><span class="n">meta_info</span><span class="p">)</span>
        <span class="n">meta_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">meta_info</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="c1"># Initialize sorted indices and metadata values</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">meta_sorted_data</span> <span class="o">=</span> <span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">][</span>
                <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
            <span class="p">]</span>
            <span class="n">meta_sorted_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="c1"># Catch conversion errors</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">meta_sorted_data</span> <span class="o">=</span> <span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">meta_sorted_value</span> <span class="o">=</span> <span class="n">meta_info</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Only retain data instances present in both datasets</span>
        <span class="n">retain_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">meta_sorted_data</span><span class="p">,</span> <span class="n">sorted_data</span><span class="p">)</span>
        <span class="n">meta_sorted_data</span><span class="p">,</span> <span class="n">meta_sorted_value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">meta_sorted_data</span><span class="p">[</span><span class="n">retain_flags</span><span class="p">],</span>
            <span class="n">meta_sorted_value</span><span class="p">[</span><span class="n">retain_flags</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="c1"># Process selection based on provided selection_num</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="c1"># 0 &lt; selection_num &lt; 1 means that we relatively select data instances by a percentage number</span>
            <span class="c1"># selection_num &lt; 0 means that we absolutely select data instances by the given value</span>
            <span class="n">selection_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="o">-</span><span class="n">selection_num</span>
                <span class="k">if</span> <span class="n">selection_num</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_sorted_data</span><span class="p">)</span> <span class="o">*</span> <span class="n">selection_num</span>
            <span class="p">)</span>
            <span class="c1"># &#39;min&#39; means the instances with the minimal meta values will be selected</span>
            <span class="k">if</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span><span class="n">selection_num</span><span class="p">:]</span>
            <span class="c1"># &#39;max&#39; means the instances with the maximal meta values will be selected</span>
            <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
                <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[:</span><span class="o">-</span><span class="n">selection_num</span><span class="p">]</span>
            <span class="c1"># &#39;middle&#39; means the instances with the minimal and maximal meta values will be excluded</span>
            <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span>
                <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">meta_sorted_data</span><span class="p">[</span>
                            <span class="p">:</span> <span class="nb">int</span><span class="p">((</span><span class="n">meta_sorted_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">selection_num</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="p">],</span>
                        <span class="n">meta_sorted_data</span><span class="p">[</span>
                            <span class="o">-</span><span class="nb">int</span><span class="p">((</span><span class="n">meta_sorted_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">selection_num</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;If selection_num is given in a integer or float number (</span><span class="si">{</span><span class="n">selection_num</span><span class="si">}</span><span class="s2">), &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;selection_mode must be one of [&#39;min&#39;, &#39;max&#39;, &#39;middle&#39;]. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;But got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># select the data instances by a given threshold</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">selection_num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">selection_num</span><span class="p">)</span>
            <span class="c1"># &#39;min&#39; means the instances whose metadata is lower than the given threshold will be selected</span>
            <span class="k">if</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
                <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span>
                    <span class="n">meta_sorted_value</span> <span class="o">&gt;</span> <span class="n">selection_num</span>
                <span class="p">]</span>
            <span class="c1"># &#39;max&#39; means the instances whose metadata is larger than the given threshold will be selected</span>
            <span class="k">elif</span> <span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
                <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span>
                    <span class="n">meta_sorted_value</span> <span class="o">&lt;</span> <span class="n">selection_num</span>
                <span class="p">]</span>
            <span class="c1"># &#39;middle&#39; is not supported for the threshold selection</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;If selection_num is given in a string (</span><span class="si">{</span><span class="n">selection_num</span><span class="si">}</span><span class="s2">), selection_mode must &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;be one of [&#39;min&#39;, &#39;max&#39;]. But got </span><span class="si">{</span><span class="n">selection_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># other strings mean the target groups of data instances</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_num</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
            <span class="n">removed_sorted_data</span> <span class="o">=</span> <span class="n">meta_sorted_data</span><span class="p">[</span>
                <span class="p">[</span>
                    <span class="kc">True</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selection_num</span> <span class="k">else</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">meta_sorted_value</span>
                <span class="p">]</span>
            <span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid type for selection_num.&quot;</span><span class="p">)</span>

        <span class="c1"># Remove undesired instances from sorted_data</span>
        <span class="n">sorted_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">sorted_data</span><span class="p">,</span> <span class="n">removed_sorted_data</span><span class="p">)</span>

    <span class="c1"># Return selected indices as list</span>
    <span class="k">return</span> <span class="n">sorted_data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.dataset_init_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dataset_init_fn</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_conf</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Hook function that initializes the custom parts of dataset implementations.</p>
<p>By default, this function does nothing. If your Dataset subclass has custom parts, override this function
with your own implementation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**dataset_conf</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arguments for the custom initialization of the Dataset subclass.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dataset_init_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">dataset_conf</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hook function that initializes the custom parts of dataset implementations.</span>

<span class="sd">    By default, this function does nothing. If your Dataset subclass has custom parts, override this function</span>
<span class="sd">    with your own implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        **dataset_conf: Arguments for the custom initialization of the Dataset subclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.extract_main_data_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_main_data_fn</span><span class="p">(</span><span class="n">main_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This hook function extracts the selected data instance from the disk to the memory. If you want to implement
your own data instance extraction, please override this hook function and give your logic here.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>main_data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, str]
The dictionary containing necessary information for extracting the data instance from the disk to the
memory. For example, the audio file path for the waveform data and the feature file path for the speaker
embedding.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Dict[str, Any]</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>] or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary containing the extracted data instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_main_data_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This hook function extracts the selected data instance from the disk to the memory. If you want to implement</span>
<span class="sd">    your own data instance extraction, please override this hook function and give your logic here.</span>

<span class="sd">    Args:</span>
<span class="sd">        main_data: Dict[str, str]</span>
<span class="sd">            The dictionary containing necessary information for extracting the data instance from the disk to the</span>
<span class="sd">            memory. For example, the audio file path for the waveform data and the feature file path for the speaker</span>
<span class="sd">            embedding.</span>

<span class="sd">    Returns: Dict[str, Any]</span>
<span class="sd">        The dictionary containing the extracted data instance.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">main_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.get_data_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_data_index</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function is designed to make users know the data indices of this Dataset object without accessing its
members for lower coupling.</p>


    <p><span class="doc-section-title">List[str]</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of the indices of all data instances in this dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_data_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is designed to make users know the data indices of this Dataset object without accessing its</span>
<span class="sd">    members for lower coupling.</span>

<span class="sd">    Returns: List[str]</span>
<span class="sd">        The list of the indices of all data instances in this dataset.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataset.abs.Dataset.remove_data_by_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_data_by_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function removes the corresponding data instance from this Dataset object by the given index. It's mainly
used for solving the index mismatch of data instances with the high-level Iterator object.</p>

            <details class="quote">
              <summary>Source code in <code>speechain/dataset/abs.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_data_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function removes the corresponding data instance from this Dataset object by the given index. It&#39;s mainly</span>
<span class="sd">    used for solving the index mismatch of data instances with the high-level Iterator object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># remove the data instances with the given index from self.main_data</span>
    <span class="k">for</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_data</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>